<article x-data="getPlayerData()">
  <div class="flex flex-col gap-2 py-2">
    <h2 class="text-base font-semibold leading-none">Email</h2>
    <div class="flex w-[50%] flex-col gap-4 py-2">
      <div class="flex h-12 items-center" x-show="!addEmailMode">
        <button
          class="inline-flex h-10 items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"
          type="button"
          @click="
            addEmailMode = true;
              $nextTick(() => {
                setTimeout(() => {
                  document.getElementById('add-email').focus();
                }, 50);
            });
          "
        >
          Add Email
        </button>
      </div>
      <form class="flex gap-2" x-cloak x-show="addEmailMode">
        <input
          id="add-email"
          class="flex h-12 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
          x-model="addEmail"
          @keydown.escape.prevent=""
          @keyup.escape="
            addEmailMode = false;
            addEmail = '';
          "
          placeholder=""
          name="add-email"
        />
        <div class="flex flex-col items-start gap-1 pt-2">
          <button
            type="submit"
            class="bg-none text-xs leading-none text-muted-foreground hover:text-primary hover:underline"
          >
            Save
          </button>
          <button
            type="button"
            @click="
              addEmailMode = false;
              addEmail = '';
            "
            class="bg-none text-xs leading-none text-muted-foreground hover:text-primary hover:underline"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
    <!-- prettier-ignore -->
    {{ if .NoEmails }}
      {{ template "web/views/partials/player/email/no-email" }}
    {{- else }}
      {{ range .Emails }}
        {{ if .Verified }}
          {{ template "web/views/partials/player/email/verified-email" . }}
        {{- else }}
          {{ template "web/views/partials/player/email/unverified-email" . }}
        {{- end}}
      {{- end }}
    {{- end }}
  </div>
</article>
