function getRegisterData(){return{username:"",password:"",confirmPassword:"",evalConfirmPassword:!1,pwLen:!1,pwEvalLen:!1,pwMixedCase:!1,pwEvalMixedCase:!1,pwNum:!1,pwEvalNum:!1,pwSpecialChar:!1,pwEvalSpecialChar:!1,submitData,sanitizeUsername,isUsernameValid,isPasswordValid,getPasswordStrengths}}async function submitData(u,pw,confirmpw){if(!isUsernameValid(u))return;if(!isPasswordValid(pw))return;if(pw!==confirmpw)return;const su=sanitizeUsername(u),body=new FormData;body.append("username",su),body.append("password",pw);try{if((await fetch("/player/new",{method:"POST",body})).status!==201)return;window.location.reload()}catch(err){return}}function sanitizeUsername(u){return u.replace(/[^a-zA-Z0-9_\-]+/gi,"").toLowerCase()}function isUsernameValid(u){if(u.length<4)return!1;if(u.length>16)return!1;if(new RegExp("[^a-z0-9_-]+","g").test(u))return!1;return!0}function isPasswordValid(pw){if(pw.length<8)return!1;if(pw.length>255)return!1;return!0}function getPasswordStrengths(pw){let strengths={len:!1,mixedCase:!1,num:!1,specialChar:!1};if(pw.length>8)strengths.len=!0;if(pw.match(/[a-z]/)&&pw.match(/[A-Z]/))strengths.mixedCase=!0;if(pw.match(/[0-9]/))strengths.num=!0;if(pw.match(/[^a-zA-Z\d]/))strengths.specialChar=!0;return strengths}function getLoginData(){return{username:"",password:"",submitLogin,sanitizeUsername}}async function submitLogin(u,pw){try{const body=new FormData;if(body.append("username",u),body.append("password",pw),(await fetch("/login",{method:"POST",body})).status!=200)return;window.location.reload()}catch{return}}function getLogoutData(){return{logout}}async function logout(){try{if((await fetch("/logout",{method:"POST"})).status!==200)return;window.location.reload()}catch{}}window.getRegisterData=getRegisterData;window.getLoginData=getLoginData;window.getLogoutData=getLogoutData;export{submitLogin,submitData,sanitizeUsername,logout,isUsernameValid,isPasswordValid,getRegisterData,getPasswordStrengths,getLogoutData,getLoginData};
